<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Convert audio</title>
<style>
/* === Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„ Ø²Ø± Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© === */
body{ overflow: hidden; margin:0;padding:0;background-color:#000;color:#fff;/*font-family:Tahoma,sans-serif*/;display:flex;justify-content:center;align-items:center;height:100vh;flex-direction:column}
.login-container{background-color:#111;padding:30px;border-radius:12px;box-shadow:0 0 20px rgba(255,255,255,0.15);text-align:center;width:90%;max-width:400px;/* Ø¨Ø¯Ù„ Ù…Ù† display:none */
  display:block}
.login-container h2{margin-bottom:20px;font-size:22px;color:#ffcc00}
.login-container input{width:90%;padding:12px;margin:10px 0;border-radius:8px;border:1px solid #444;background-color:#1a1a1a;color:#fff;font-size:16px;text-align:center;direction:ltr;unicode-bidi:embed}
.login-container label{font-size:14px;display:inline-block;align-items:center;justify-content:center;gap:1px;margin-top:10px;cursor:pointer;width:-55â„…;text-align:center;position:relative;top:11px}
.login-container button{padding:12px 24px;font-size:18px;margin-top:15px;border:none;border-radius:8px;background-color:#4CAF50;color:white;cursor:pointer;transition:0.3s}
.login-container button:hover{opacity:0.85}
.container{top:-34px;background-color:#111;padding:25px;border-radius:12px;box-shadow:0 0 20px rgba(255,255,255,0.1);text-align:center;width:82%;max-width:600px;transition:all 0.3s ease;display:none;position:relative}
h1{font-family:bodoni,cursive; color:rgba(196, 144, 217, 0.70); margin-bottom:0px;font-size:17px;transition:font-size 0.3s ease}
button{padding:12px 24px;font-size:18px;margin:0px 0px;border:none;border-radius:8px;cursor:pointer;transition:0.3s,font-size 0.3s ease,padding 0.3s ease}
#startBtn{background-color:#4CAF50;color:white}
#stopBtn{background-color:#f44336;color:white;display:none}
button:hover{opacity:0.85}
#recordingIndicator{display:none;color:#ff5252;font-weight:bold;font-size:11px;margin-top:0px}
#recordingDot{display:inline-block;width:12px;height:12px;background-color:red;border-radius:50%;margin-left:8px;animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}
#output{background:#222;border:1px solid #444;padding:15px; width:93%; border-radius:8px;margin-top:5px;font-size:18px;min-height:5px; /*white-space:pre-wrap;*/color:#ddd;transition:font-size 0.3s ease,padding 0.3s ease;direction:rtl;unicode-bidi:embed;text-align:center;position:relative;user-select:none}
#outputText{pointer-events:none} 
textarea{width:96%;margin-top:15px;padding:12px;font-size:16px;border-radius:6px;border:1px solid #555;background-color:#1a1a1a;color:#fff;resize:vertical;transition:font-size 0.3s ease,padding 0.3s ease}
#userCountContainer{top:-22px;left:15px;right:15px;display:flex;align-items:center;font-size:13px;opacity:0.8;justify-content:space-between}
#userCount{color:#0f0}
#logoutBtn{font-size:12px;padding:4px 8px;border-radius:6px;border:none;background-color:#f44336;color:white;cursor:pointer;opacity:0.9}
footer{margin-top:15px;font-size:14px;color:#b17215;text-align:center}
@keyframes rgbGlow{0%{box-shadow:0 0 40px 15px rgba(255,0,0,0.25)}20%{box-shadow:0 0 40px 15px rgba(255,165,0,0.25)}40%{box-shadow:0 0 40px 15px rgba(0,255,0,0.25)}60%{box-shadow:0 0 40px 15px rgba(0,255,255,0.25)}80%{box-shadow:0 0 40px 15px rgba(0,0,255,0.25)}100%{box-shadow:0 0 40px 15px rgba(255,0,255,0.25)}}
.container.recording{animation:rgbGlow 10s infinite linear}
.ltr-num {
  direction: ltr;
  unicode-bidi: embed;
}

#signup {
  display:none;   /* Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙŠØ¸Ù„ Ù…Ø®ÙÙŠ */
}
#autoRestartCheckbox:hover + #autoRestartTooltip {
    visibility: visible;
    opacity: 1;
}
/* === ØªØ¹Ø¯ÙŠÙ„ Ø²Ø± Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© === */
#smartWordsBtn {
    position: absolute;
    top: 2px;
    left: 5px;
    padding: 3px 6px;
    font-size: 12px;
    background-color: #564d4d;
    color: #fff;
    border: none;
    /*border-radius: 4px;*/
    cursor: pointer;
    z-index: 50;
}
#smartWordsMenu {
    position: absolute;
    top: 25px;
    left: 5px;
    background: #222;
    border: 1px solid #555;
    border-radius: 6px;
    padding: 6px;
    display: none;
    flex-direction: column;
    gap: 4px;
    z-index: 51;
    width:80%;
}
.smartWordItem{display:flex;justify-content:space-between;align-items:center;background:#333;padding:2px 6px;border-radius:4px;cursor:pointer}
.smartWordItem span{flex:1;text-align:center}
.smartWordItem button{background:red;color:#fff;border:none;border-radius:4px;padding:0 4px;margin-left:4px;cursor:pointer}
#smartAddInput{display:flex;gap:4px;margin-bottom:4px}
#smartAddInput input{flex:1;padding:4px;border-radius:4px;border:1px solid #555;background:#111;color:#fff;width:70px;font-size:11px}
#smartAddInput button{padding:4px 8px;border-radius:4px;border:none;background:#4CAF50;color:#fff;font-size:12px;cursor:pointer}

/* === Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠØ© === */
#menuBtn{
    position: absolute;
    /*top: 0px;*/
    left: 17px;
    padding: 6px 12px;
    font-size: 14px;
    border-radius: 6px;
    border: none;
    background-color: #444;
    color: #fff;
    cursor: pointer;
    z-index: 1000;
}
/* === Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø§Ù„Ù…ØµØºØ±Ø© ÙˆØ§Ù„Ù…Ù†Ø³Ù‚Ø© === */
#sideMenu {
    position: absolute;
    top: 17px;
    left: 17px;
    width: 111px; /* Ø¬Ø¹Ù„Ù‡Ø§ Ø£Ù‚Ù„ Ø¹Ø±Ø¶Ù‹Ø§ */
    background-color: #0a0909;
    border: 1px solid #444;
    border-radius: 8px;
    padding: 12px 8px 12px 12px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø§Ø¯ÙŠÙ†Ø¬ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† */
    display: none;
    flex-direction: column;
    gap: 10px;
    z-index: 1000;
    box-shadow: 3px 3px 12px rgba(0,0,0,0.5);
    transition: transform 0.3s ease, opacity 0.3s ease;
    transform: translateX(-220px);
    opacity: 0;
}

/* Ø¸Ù‡ÙˆØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
#sideMenu.show {
    display: flex;
    transform: translateX(0);
    opacity: 1;
}

/* ÙƒÙ„Ù…Ø© Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø§Ù„ØµØºÙŠØ±Ø© ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
#backBtn {
    background: none;
    border: none;
    color: #ffcc00;
    font-size: 13px;
    font-weight: bold;
    text-align: left;
    cursor: pointer;
    padding: 0;
    margin-bottom: 8px;
    transition: color 0.2s ease;
}
#backBtn:hover {
    color: #ffff66;
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø®Ø±Ù‰ */
#sideMenu .menuItem {
    padding: 8px 10px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø§Ø¯ÙŠÙ†Ø¬ Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background-color: #222;
    color: #fff;
    text-align: center;
    font-size: 14px;
    transition: background 0.2s ease, transform 0.2s ease;
}
#sideMenu .menuItem:hover {
    background-color: #444;
    transform: translateX(3px);
}

/* === Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø´Ø§Ø´Ø© === */
@media (max-width:500px){.container{padding:20px}.container h1{font-size:20px}button{font-size:16px;padding:10px 18px}#output{font-size:16px;padding:12px}textarea{font-size:14px;padding:10px}}
@media (max-width:350px){.container{padding:15px}.container h1{font-size:18px}button{font-size:14px;padding:8px 16px}#output{font-size:14px;padding:10px}textarea{font-size:13px;padding:8px}}
</style>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyDa1_gisk5GuTvRzACp0lA1TGe3-b2Sz8A",
  authDomain: "dragon-tv-3e8c1.firebaseapp.com",
  databaseURL: "https://dragon-tv-3e8c1-default-rtdb.firebaseio.com",
  projectId: "dragon-tv-3e8c1",
  storageBucket: "dragon-tv-3e8c1.firebasestorage.app",
  messagingSenderId: "909817368695",
  appId: "1:909817368695:web:b5e9ffccafefcbc41a7672"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
// ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„Ø¬Ù‡Ø§Ø²
const deviceId = localStorage.getItem("deviceId") || crypto.randomUUID();
localStorage.setItem("deviceId", deviceId);



    db.ref("users").orderByChild("username").equalTo(username).once("value").then(snapshot => {
        if (!snapshot.exists()) {
            alert("âš  Ø§Ù„Ø­Ø³Ø§Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!");
            return;
        }

        let correctPassword = false;
        let userKey = null;

        snapshot.forEach(child => {
            const data = child.val();
            userKey = child.key;
            if(data.password === password) correctPassword = true;
        });

        if(!correctPassword){
            alert("âš  ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!");
            return;
        }

        const userStatusRef = db.ref("onlineUsers/" + userKey);

        userStatusRef.once("value").then(snap => {
            if(snap.exists()){
                const currentDevice = snap.val().deviceId;
                if(currentDevice !== deviceId){
                    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø³Ø§Ø¨Ù‚
                    userStatusRef.set({ deviceId: deviceId });
                    alert("âš  ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ù† Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±ØŒ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬Ùƒ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø³Ø§Ø¨Ù‚.");
                }
            } else {
                userStatusRef.set({ deviceId: deviceId });
            }

            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ØºÙ„Ù‚ Ø§Ù„ØµÙØ­Ø©
            userStatusRef.onDisconnect().remove();

            // Ø¹Ø±Ø¶ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            document.getElementById("login").style.display = "none";
            document.getElementById("app").style.display = "block";
        });
    });

// ===== ÙƒÙˆØ¯ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ =====
function openSignup() {
  document.getElementById("login").style.display = "none";
  document.getElementById("signup").style.display = "block";
}

function backToLogin() {
  document.getElementById("signup").style.display = "none";
  document.getElementById("login").style.display = "block";
}

function loginUser() {
  const user = document.getElementById("username").value;
  const pass = document.getElementById("password").value;

  // ØªØ­Ù‚Ù‚ Ù…Ø¤Ù‚Øª
  if (user === "admin" && pass === "123") {
    document.getElementById("login").style.display = "none";
    document.getElementById("app").style.display = "block";
  } else {
    document.getElementById("error").style.display = "block";
  }
}

</script>
</head>
<body>

 <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ -->
<div class="login-container" id="signup" style="display:none">
  <h2>âŸ± Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ âŸ±</h2>
  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ -->
  <!-- Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·) -->
  <input type="text" id="signupUsername"placeholder="Ø£Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"><br><br>
  
  <!-- Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ -->
  <input type="text" id="signupPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" oninput="this.value=this.value.replace(/[^0-9]/g,'')"><br><br>
  
  <!-- Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ -->
  <button onclick="registerUser()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
  
  <!-- Ø²Ø± Ø¥Ù„ØºØ§Ø¡ -->
  <button onclick="backToLogin()">Ø¥Ù„ØºØ§Ø¡</button>

  <!-- Ø§Ù„ØªÙ„Ù…ÙŠØ­ -->
  <div style="margin-top:20px; text-align:right; font-size:14px; color:#ccc; line-height:1.8;">
    <p>ğŸ”” ÙŠØ¬Ø¨ ØªØ­ÙˆÙŠÙ„ Ø±ØµÙŠØ¯ Ù„Ù„ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:</p>
    <ul style="margin:0; padding-right:20px;">
      <li>Ù…Ø´ØªØ±ÙƒÙŠ <strong>Ø¢Ø³ÙŠØ§</strong></li>
      <li>Ù…Ø´ØªØ±ÙƒÙŠ <strong>ÙƒÙˆØ±Ùƒ</strong></li>
      <li>Ù…Ø´ØªØ±ÙƒÙŠ <strong>Ø²ÙŠÙ†</strong></li>
    </ul>
  </div>
</div>

<!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø§Ø²Ù… ØªØ¸Ù‡Ø± Ø£ÙˆÙ„ Ù…Ø§ ÙŠÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
<div class="login-container" id="login">
  <h2>âŸ± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ âŸ±</h2>
  <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
  <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <label><input type="checkbox" id="rememberMe">Ø°ÙƒØ±Ù†ÙŠ</label>
  <button onclick="loginUser()">Ø¯Ø®ÙˆÙ„</button>
  <button onclick="openSignup()" style="margin-left:10px;">Ø§Ø´ØªØ±Ø§Ùƒ</button>
  <p id="error" style="color:red; display:none;">!! Ø®Ø·Ø£ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</p>
</div>

<br>
<div class="container" id="app">
<div id="userCountContainer">
  <div id="userCount"># Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: 0</div>
 <!-- Ø§Ù„Ø²Ø± Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© -->
<button id="menuBtn">â˜° Ù‚Ø§Ø¦Ù…Ø©</button>

<!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
<div id="sideMenu">
    <button id="backBtn">Ø±Ø¬ÙˆØ¹</button>
    <button class="menuItem" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
    <button class="menuItem" onclick="helpModal.style.display='block'">Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª</button>
</div>
 
</div>
<h1> [ Convert Audio To Text In Iraqi ]</h1><br>
<button id="startBtn" onclick="startRecognition()">[â–¶ï¸] Ø£Ø¨Ø¯Ø¡ Ø§Ù„ÙƒÙ„Ø§Ù…</button>
<label style="display:inline-flex;/*margin-right:10px;*/ cursor:pointer; user-select:none; position:relative; flex-direction:column; top:-2%">
  <input type="checkbox" id="autoRestartCheckbox">  Ù…Ø³ØªÙ…Ø±
  <span id="autoRestartTooltip" style="
        visibility:hidden;
        background-color:#333;
        color:#fff;
        text-align:center;
        border-radius:6px;
        padding:5px;
        position:absolute;
        z-index:100;
        font-size:12px;
        top:-30px;
        right:0;
        opacity:0;
        transition: opacity 0.3s;">
    Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± Ø³ÙŠØ¹Ù…Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø¯ÙˆÙ† ØªÙˆÙ‚Ù
  </span>
</label>
<button id="stopBtn" onclick="stopRecognition()">[X] Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒÙ„Ø§Ù…</button>

<div id="recordingIndicator">
  <span id="recordingDot"></span> â–¶ï¸ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...
</div>

<div id="output">
  <div id="outputText"></div>
  <button id="smartWordsBtn">ØªØµØ­ÙŠØ­</button>
  <div id="smartWordsMenu">
    <div id="smartAddInput">
      <input type="text" id="wrongWord" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø©">
      <input type="text" id="correctWord" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ØªØµØ­ÙŠØ­">
      <button onclick="addSmartWord()">Ø¥Ø¶Ø§ÙØ©</button>
    </div>
    <div id="smartWordsList"></div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ (ØµØºÙŠØ±ØªØ§Ù† ÙˆÙ…ØªÙ†Ø§Ø³Ù‚ØªØ§Ù†) -->
    <div style="display:flex; gap:4px; margin-top:-6px; justify-content:right;">
      <button onclick="exportSmartWords()" 
              style="padding:2px 6px;background:#4CAF50;color:#fff;border:none;border-radius:4px;font-size:12px;">ØªØµØ¯ÙŠØ±</button>
      
      <button onclick="document.getElementById('importFile').click()" 
              style="padding:2px 6px;background:#2196F3;color:#fff;border:none;border-radius:4px;font-size:12px;">Ø§Ø³ØªÙŠØ±Ø§Ø¯</button>
      <input type="file" id="importFile" accept=".json" style="display:none" onchange="importSmartWords(event)">
    </div>
  </div>
</div>

<div id="historyContainer" style="
    width:100%; min-height:110px; max-height:120px;
    border:1px solid #555; border-radius:6px;
    background:#1a1a1a; margin-top:11px;
    display:flex; flex-direction:column; gap:6px;
">

  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ Ù„Ù„Ø£Ø²Ø±Ø§Ø± -->
  <div style="display:flex; justify-content:space-between; padding:3px;">
    <button id="toggleHistoryBtn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶"
      style="background-color:#564d4d; color:#c5b4b4; padding:3px 8px; font-size:12px;">
      â‡„
    </button>

    <button id="copyAllHistoryBtn" title="Ù†Ø³Ø® Ø§Ù„ÙƒÙ„"
      style="background-color:#353d48; color:#c5b4b4; padding:3px 8px; font-size:12px;">
      Ù†Ø³Ø® Ø§Ù„ÙƒÙ„
    </button>
  </div>

  <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ø¬Ù„ -->
  <div id="history" style="
      flex:1; overflow-y:auto; padding:5px;
      display:flex; flex-direction:column; gap:4px;
      align-items:center; text-align:center;
  ">
  </div>

  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ -->
  <div style="display:flex; justify-content:right; padding:3px;">
    <button id="clearHistoryBtn" title="Ø­Ø°Ù Ø§Ù„ÙƒÙ„"
      style=" background-color:#8f2424; color:#c5b4b4;
             border:none; border-radius:6px;
             font-size:12px; padding:4px 8px; cursor:pointer;">
      Ø­Ø°Ù Ø§Ù„ÙƒÙ„
    </button>
  </div>
</div>

<br>
<footer>
  &copy; DRAGON&CHEAT 2025 
</footer>

<div id="helpModal" style="
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    max-width: 400px;
    background-color: #111;
    color: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 0 20px rgba(255,255,255,0.3);
    text-align: center;
    z-index: 10000;
">
    <h3>ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3>
    <p>

       
        0. Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±. <br>
        1. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± â–¶ï¸ Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ Ù„Ù„ÙƒÙ„Ø§Ù….<br>
        2. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± X Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ ÙƒÙ„Ø§Ù….<br>
        3. ÙŠØ¯Ø¹Ù… Ø§Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙØµØ­Ù‰-Ø¹Ø±Ø§Ù‚ÙŠØ© ÙˆØ§Ø±Ù‚Ø§Ù… Ù„Ø§ØªÙŠÙ†ÙŠØ©.<br>
        4. ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø® Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ­Ø°ÙÙ‡Ø§ Ù…Ù† ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®.<br>
        5. ÙŠÙ…ÙƒÙ†Ùƒ ÙƒØªØ§Ø¨Ø© ØªØµØ­ÙŠØ­ ÙˆØ­ÙØ¸ Ù„Ø§ÙŠÙÙ‡Ù…Ù‡ Ù…Ø­Ø±Ùƒ<br>
        6.Ø¯Ø¹Ù… Ù„Ù„Ø³Ù†ÙˆØ§Øª ÙˆØ§Ø´Ù‡Ø± ÙˆØ§Ù„Ø§ÙŠØ§Ù… Ø¹Ù†Ø¯ Ù†Ø·Ù‚ Ø¨Ù‡Ø§ Ø¹Ù†Ø¯ ÙƒÙ„Ø§Ù… <br>
        7.ÙŠØ¬Ø¨ Ø§Ù† ÙŠØªÙˆÙØ± Ù„Ø¯ÙŠÙƒ Ù…ÙƒØ±ÙÙˆÙ† ÙˆØ£Ù†ØªØ±Ù†Øª Ù…Ø³ØªÙ‚Ø±  <br><br>
      Â®Ø¬Ù…ÙŠØ¹ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©â„¢
    </p>
    <button onclick="helpModal.style.display='none'" 
        style="margin-top:15px;padding:8px 16px;border:none;border-radius:8px;background-color:#4CAF50;color:white;cursor:pointer;">
        Ø¥ØºÙ„Ø§Ù‚
    </button>
</div>


// === Ø¯ÙˆØ§Ù„ Firebase + ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ===
function base64EncodeUnicode(str){return btoa(unescape(encodeURIComponent(str)));}
const deviceId = crypto.randomUUID();
function updateUserOnlineStatus(username,online){const ref=db.ref('onlineUsers/'+username+'/'+deviceId);if(online){ref.set(true);ref.onDisconnect().remove();}else{ref.remove();db.ref('onlineUsers/'+username).once('value',snap=>{if(!snap.exists()){db.ref('onlineUsers/'+username).remove();}});}}
db.ref('onlineUsers').on('value',snapshot=>{document.getElementById("userCount").textContent="# Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: "+snapshot.numChildren();});

function logout(){const user=document.getElementById("username").value.trim();updateUserOnlineStatus(user,false);localStorage.removeItem("loggedIn");sessionStorage.removeItem("loggedInSession");document.getElementById("app").style.display="none";document.getElementById("login").style.display="block";}
window.onload=function(){const loggedInPermanent=localStorage.getItem("loggedIn")==="true";const loggedInSession=sessionStorage.getItem("loggedInSession")==="true";if(loggedInPermanent && !loggedInSession){alert("âˆš Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø§Ù„Ø¢Ù†...");sessionStorage.setItem("loggedInSession","true");location.reload();return;}if(loggedInPermanent||loggedInSession){const user=document.getElementById("username").value.trim();document.getElementById("login").style.display="none";document.getElementById("app").style.display="block";updateUserOnlineStatus(user,true);window.addEventListener("beforeunload",()=>updateUserOnlineStatus(user,false));}else{document.getElementById("login").style.display="block";}}
</script>
<script>
// Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ± Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
document.getElementById("username").addEventListener("keydown", function(e){
  if(e.key === "Enter"){
    e.preventDefault();
    document.getElementById("password").focus();
  }
});
</script>
<script>
// === Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ + ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¥Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… + Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© ===
let recognition;
let smartWords = {};
const autoRestartCheckbox = document.getElementById("autoRestartCheckbox");

function applySmartWords(text) {
  for (const wrong in smartWords) {
    if (smartWords.hasOwnProperty(wrong)) {
      const correct = smartWords[wrong];
      // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒÙ„ ÙƒÙ„Ù…Ø© Ø®Ø§Ø·Ø¦Ø© Ø¨Ø§Ù„ØªØµØ­ÙŠØ­
      text = text.split(wrong).join(correct);
    }
  }
  return text;
}
  
  function wordsToNumbersInText(text) {
  const units = {
    "ØµÙØ±":0,"ÙˆØ§Ø­Ø¯":1,"ÙˆØ§Ø­Ø¯Ø©":1,"Ø§Ø­Øª":1,"Ø§Ø­Ø¯Ø¹":1,
    "Ø§Ø«Ù†Ø§Ù†":2,"Ø§Ø«Ù†ÙŠÙ†":2,"Ø§Ø«Ù†ØªØ§Ù†":2,"Ø§Ø«Ù†ØªÙŠÙ†":2,"Ø«Ù†ÙŠÙ†":2,
    "Ø«Ù„Ø§Ø«Ø©":3,"Ø«Ù„Ø§Ø«":3,"Ø§ØªÙ„Ø§Ø«Ù‡":3,"ØªÙ„Ø§Øª":3,"ØªÙ„Ø«":3,
    "Ø£Ø±Ø¨Ø¹Ø©":4,"Ø§Ø±Ø¨Ø¹Ù‡":4,"Ø§Ø±Ø¨Ø¹":4,
    "Ø®Ù…Ø³Ø©":5,"Ø®Ù…Ø³Ù‡":5,
    "Ø³ØªØ©":6,"Ø³ØªÙ‡":6,
    "Ø³Ø¨Ø¹Ø©":7,"Ø³Ø¨Ø¹Ù‡":7,
    "Ø«Ù…Ø§Ù†ÙŠØ©":8,"Ø«Ù…Ø§Ù†ÙŠÙ‡":8,"Ø«Ù…Ù†":8,"Ø§Ø«Ù…Ù†":8,
    "ØªØ³Ø¹Ø©":9,"ØªØ³Ø¹Ù‡":9
  };

  const teens = {
    "Ø¹Ø´Ø±Ø©":10,"Ø¹Ø´Ø±":10,
    "Ø§Ø­Ø¯ Ø¹Ø´Ø±":11,"Ø£Ø­Ø¯ Ø¹Ø´Ø±":11,"Ø§Ø­Ø¯Ù‰ Ø¹Ø´Ø±":11,"Ø¥Ø­Ø¯Ù‰ Ø¹Ø´Ø±":11,"Ø§Ø­Ø¯Ø¹Ø´":11,
    "Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±":12,"Ø§Ø«Ù†ÙŠ Ø¹Ø´Ø±":12,"Ø§Ø«Ù†Ø¹Ø´":12,"Ø«Ù†Ø¹Ø´":12,
    "Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±":13,"Ø«Ù„Ø§Ø« Ø¹Ø´Ø±":13,"ØªÙ„Ø§ØªØ·Ø¹Ø´":13,"ØªÙ„Ø·Ø¹Ø´":13,
    "Ø£Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±":14,"Ø§Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±":14,"Ø§Ø±Ø¨Ø¹ØªØ¹Ø´":14,
    "Ø®Ù…Ø³Ø© Ø¹Ø´Ø±":15,"Ø®Ù…Ø³Ø·Ø¹Ø´":15,
    "Ø³ØªØ© Ø¹Ø´Ø±":16,"Ø³ØªØ·Ø¹Ø´":16,
    "Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±":17,"Ø³Ø¨Ø¹Ø·Ø¹Ø´":17,
    "Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±":18,"Ø«Ù…Ø§Ù†Ø·Ø¹Ø´":18,"Ø«Ù…Ù†Ø·Ø¹Ø´":18,
    "ØªØ³Ø¹Ø© Ø¹Ø´Ø±":19,"ØªØ³Ø¹Ø·Ø¹Ø´":19
  };

  const tens = {
    "Ø¹Ø´Ø±ÙˆÙ†":20,"Ø¹Ø´Ø±ÙŠÙ†":20,
    "Ø«Ù„Ø§Ø«ÙˆÙ†":30,"Ø«Ù„Ø§Ø«ÙŠÙ†":30,
    "Ø£Ø±Ø¨Ø¹ÙˆÙ†":40,"Ø§Ø±Ø¨Ø¹ÙŠÙ†":40,
    "Ø®Ù…Ø³ÙˆÙ†":50,"Ø®Ù…Ø³ÙŠÙ†":50,
    "Ø³ØªÙˆÙ†":60,"Ø³ØªÙŠÙ†":60,
    "Ø³Ø¨Ø¹ÙˆÙ†":70,"Ø³Ø¨Ø¹ÙŠÙ†":70,
    "Ø«Ù…Ø§Ù†ÙˆÙ†":80,"Ø«Ù…Ø§Ù†ÙŠÙ†":80,
    "ØªØ³Ø¹ÙˆÙ†":90,"ØªØ³Ø¹ÙŠÙ†":90
  };

  const hundreds = {
    "Ù…Ø§Ø¦Ø©":100,"Ù…Ø¦Ø©":100,"Ù…ÙŠØ©":100,"Ù…ÙŠÙ‘Ù‡":100,
    "Ù…Ø¦ØªÙŠÙ†":200,"Ù…ÙŠØªÙŠÙ†":200,
    "Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©":300,"Ø«Ù„Ø§Ø«Ù…ÙŠØ©":300,"ØªÙ„Ø«Ù…ÙŠØ©":300,
    "Ø£Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©":400,"Ø§Ø±Ø¨Ø¹Ù…Ø§ÙŠØ©":400,"Ø§Ø±Ø¨Ø¹Ù…ÙŠØ©":400,
    "Ø®Ù…Ø³Ù…Ø§Ø¦Ø©":500,"Ø®Ù…Ø³Ù…Ø§ÙŠØ©":500,
    "Ø³ØªÙ…Ø§Ø¦Ø©":600,"Ø³ØªÙ…ÙŠØ©":600,
    "Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©":700,"Ø³Ø¨Ø¹Ù…ÙŠØ©":700,
    "Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©":800,"Ø«Ù…Ø§Ù†Ù…ÙŠØ©":800,"Ø«Ù…Ù†Ù…ÙŠØ©":800,
    "ØªØ³Ø¹Ù…Ø§Ø¦Ø©":900,"ØªØ³Ø¹Ù…ÙŠØ©":900,"ØªØ³Ø¹Ù…ÙŠÙ‡":900
  };

  const multipliers = {
    "Ø£Ù„Ù":1000,"Ø§Ù„Ù":1000,
    "Ø£Ù„ÙÙŠÙ†":2000,"Ø§Ù„ÙÙŠÙ†":2000,
    "Ø¢Ù„Ø§Ù":1000,"ØªØ§Ù„Ø§Ù":1000,
    "Ù…Ù„ÙŠÙˆÙ†":1000000,"Ù…Ù„ÙŠÙˆÙ†Ø§Ù†":2000000,"Ù…Ù„ÙŠÙˆÙ†ÙŠÙ†":2000000,
    "Ù…Ù„Ø§ÙŠÙŠÙ†":1000000
  };

  const allWords = { ...units, ...teens, ...tens, ...hundreds, ...multipliers };

  const tokens = text.replace(/ØŒ/g, " ").replace(/ Ùˆ /g, " ").trim().split(/\s+/);
  let resultWords = [];
  let numberBuffer = [];

  function processBuffer(buffer) {
    let total = 0, current = 0;
    buffer.forEach(word => {
      if (teens[word] !== undefined) current += teens[word];
      else if (units[word] !== undefined) current += units[word];
      else if (tens[word] !== undefined) current += tens[word];
      else if (hundreds[word] !== undefined) current += hundreds[word];
      else if (multipliers[word] !== undefined) {
        if (multipliers[word] >= 1000) {
          current = (current === 0 ? 1 : current) * multipliers[word];
          total += current;
          current = 0;
        } else {
          current *= multipliers[word];
        }
      }
    });
    total += current;
    return total.toLocaleString("en-US");
  }

  for (let i = 0; i < tokens.length; i++) {
    const word = tokens[i];
    const twoWords = word + " " + (tokens[i+1] || "");
    if (teens[twoWords]) {
      numberBuffer.push(twoWords);
      i++;
      continue;
    }
    if (allWords[word]) {
      numberBuffer.push(word);
    } else {
      if (numberBuffer.length > 0) {
        const num = processBuffer(numberBuffer);
        resultWords.push('<span class="ltr-num">' + num + '</span>');
        numberBuffer = [];
      }
      resultWords.push(" " + word);
    }
  }
  if (numberBuffer.length > 0) {
    const num = processBuffer(numberBuffer);
    resultWords.push('<span class="ltr-num">' + num + '</span>');

  }
  return resultWords.join(" ").trim();
}  
      
function extractDateFromText(text){
  const regex=/(\d{4})[\/\\](\d{1,2})[\/\\](\d{1,2})/;
  const match=text.match(regex);
  if(match){
    let [_,year,month,day]=match.map(Number);
    if(year>=1000 && year<=2999 && month>=1 && month<=12 && day>=1 && day<=31){
      return `${year}/${String(month).padStart(2,"0")}/${String(day).padStart(2,"0")}`;
    }
  }
  if(/Ø³Ù†Ø©|Ø´Ù‡Ø±|ÙŠÙˆÙ…/.test(text)){
    const parts=text.split(/\s+/).map(p=>parseInt(p)).filter(n=>!isNaN(n));
    if(parts.length>=3){
      const [year,month,day]=parts;
      if(year>=1000 && year<=2999 && month>=1 && month<=12 && day>=1 && day<=31){
        return `${year}/${String(month).padStart(2,"0")}/${String(day).padStart(2,"0")}`;
      }
    }
  }
  return null;
}

function startRecognition(){
  const SpeechRecognition = window.webkitSpeechRecognition;
  if(!SpeechRecognition){
    alert("âŒ Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØªØ¹Ù…Ù„ ÙÙ‚Ø· Ø¹Ù„Ù‰ Ù…ØªØµÙØ­ Chrome.");
    return;
  }

  recognition = new SpeechRecognition();
  recognition.lang = 'ar-IQ';
  recognition.interimResults = false;

  recognition.onstart = function(){
    document.querySelector(".container").classList.add("recording");
    document.getElementById("recordingIndicator").style.display = "block";
    document.getElementById("startBtn").style.display = "none";
    document.getElementById("stopBtn").style.display = "inline-block";
  };
// ÙÙ„ØªØ± Ù„ØªØ­Ø¯ÙŠØ¯ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 3 Ù…Ø±Ø§Øª
function limitNumberRepeats(text) {
  return text.replace(/\b(\d)\b(\s+\1){3,}/g, (match, num) => {
    return num.repeat(3); // ÙŠØ®Ù„ÙŠ Ø§Ù„Ø±Ù‚Ù… ÙŠØªÙƒØ±Ø± 3 Ù…Ø±Ø§Øª ÙÙ‚Ø·
  });
}  
  recognition.onresult = function(event) {
    try {
      const transcript = event.results[0][0].transcript || "";

      let preApplied = applySmartWords(transcript);
      let converted = wordsToNumbersInText(preApplied || "");
      converted = applySmartWords(converted);

    // âœ¨ ÙÙ„ØªØ± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªÙƒØ±Ø§Ø± Ù„Ù„Ø£Ø±Ù‚Ø§Ù… âœ¨
    converted = limitNumberRepeats(converted);

      const dateFormat = extractDateFromText(converted);
      const outputText = dateFormat ? dateFormat : converted;

      // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ø¹ HTML Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      document.getElementById("outputText").innerHTML = outputText;
      addToHistory(outputText);

      // Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ø§Ù„Ù†Ø¸ÙŠÙ ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† Ø£ÙŠ <span>
      const tempDiv = document.createElement("div");
      tempDiv.innerHTML = outputText;
      const cleanText = tempDiv.textContent || tempDiv.innerText || "";
      navigator.clipboard.writeText(cleanText).catch(()=>{});
  } catch (err) {
    console.error("onresult error:", err);
  }
};

    recognition.onend = function(){
    document.querySelector(".container").classList.remove("recording");
    document.getElementById("recordingIndicator").style.display = "none";
    document.getElementById("startBtn").style.display = "inline-block";
    document.getElementById("stopBtn").style.display = "none";

    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¥Ø°Ø§ ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„
    if(autoRestartCheckbox.checked) {
      startRecognition();
    }
  };

  recognition.start();
}

function stopRecognition(){ 
  if(recognition){ recognition.stop(); }
}
document.getElementById("startBtn").onclick = startRecognition;
document.getElementById("stopBtn").onclick = stopRecognition;

// === Ø³Ø¬Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® ===
const historyEl = document.getElementById("history");
const toggleBtn = document.getElementById("toggleHistoryBtn");
const copyAllBtn = document.getElementById("copyAllHistoryBtn");
let isHorizontal = false;
const clearAllBtn = document.getElementById("clearHistoryBtn");
clearAllBtn.addEventListener("click", ()=>{
  historyEl.innerHTML = ""; // ÙŠÙ…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø³Ø¬Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©
});

toggleBtn.addEventListener("click", ()=>{
  if(isHorizontal){
    historyEl.style.flexDirection = "column";
    historyEl.style.flexWrap = "nowrap";
  } else {
    historyEl.style.flexDirection = "row";
    historyEl.style.flexWrap = "wrap";
  }
  isHorizontal = !isHorizontal;
});

copyAllBtn.addEventListener("click", ()=>{
  let allText = Array.from(historyEl.children)
    .map(d => d.childNodes[0].textContent.trim()) // Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø²Ø± Ø§Ù„Ø­Ø°Ù (X)
    .join(isHorizontal ? " " : "\n"); // Ø£ÙÙ‚ÙŠ = Ù…Ø³Ø§ÙØ© / Ø¹Ù…ÙˆØ¯ÙŠ = Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯

  navigator.clipboard.writeText(allText).then(()=>{
    const existingIcon = copyAllBtn.querySelector("span");
    if(existingIcon) existingIcon.remove();
    const icon = document.createElement("span");
    icon.innerText = "[âˆš]";
    icon.style.marginLeft = "6px";
    copyAllBtn.appendChild(icon);
    setTimeout(()=>{icon.remove();},1000);
  });
});

function addToHistory(text){
  const lineDiv = document.createElement("div");
  lineDiv.style.display = "flex";
  lineDiv.style.alignItems = "center";
  lineDiv.style.gap = "6px";
  lineDiv.style.padding = "2px 6px";
  lineDiv.style.background = "#1a1a1a";
  lineDiv.style.borderRadius = "4px";
  lineDiv.style.margin = "2px 2px";
  lineDiv.style.width = "auto";

  // Ø¹Ù†ØµØ± Ù…Ø¤Ù‚Øª Ù„ØªØ­ÙˆÙŠÙ„ HTML Ø¥Ù„Ù‰ Ù†Øµ Ø®Ø§Ù…
  const tempDiv = document.createElement("div");
  tempDiv.innerHTML = text;
  const cleanText = tempDiv.textContent || tempDiv.innerText || "";

  // Ø§Ù„Ù†Øµ
  const spanText = document.createElement("span");
  spanText.innerText = cleanText; // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Øµ Ø§Ù„Ù†Ø¸ÙŠÙ
  spanText.style.cursor = "pointer";
  spanText.style.flex = "1";
  spanText.style.textAlign = "center";

  // Ù†Ø³Ø® Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·
  spanText.addEventListener("click", ()=>{
    navigator.clipboard.writeText(cleanText).then(()=>{
      const copyIcon = document.createElement("span");
      copyIcon.innerText = "[âˆš]";
      copyIcon.style.marginLeft = "6px";
      spanText.appendChild(copyIcon);
      setTimeout(()=>{copyIcon.remove();},1000);
    });
  });

  // Ø²Ø± Ø§Ù„Ø­Ø°Ù âŒ
  const delBtn = document.createElement("button");
  delBtn.innerText = "X";
  delBtn.style.background = "red";
  delBtn.style.color = "white";
  delBtn.style.border = "none";
  delBtn.style.borderRadius = "3px";
  delBtn.style.cursor = "pointer";
  delBtn.style.fontSize = "12px";
  delBtn.style.padding = "0 3px";

  delBtn.addEventListener("click", (e)=>{
    e.stopPropagation(); // Ù…Ù†Ø¹ Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø­Ø°Ù
    lineDiv.remove();
  });

  lineDiv.appendChild(spanText);
  lineDiv.appendChild(delBtn);

  if (historyEl.firstChild) {
    historyEl.insertBefore(lineDiv, historyEl.firstChild); 
  } else {
    historyEl.appendChild(lineDiv);
  }

  historyEl.scrollTop = 0;
}

function toggleSmartMenu(){smartMenu.style.display="none";}

// === Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠØ© ===
const menuBtn = document.getElementById('menuBtn');
const sideMenu = document.getElementById('sideMenu');
const backBtn = document.getElementById('backBtn');

menuBtn.addEventListener('click', () => {
    sideMenu.classList.add('show');
    menuBtn.style.display = 'none';
});

backBtn.addEventListener('click', () => {
    sideMenu.classList.remove('show');
    setTimeout(() => menuBtn.style.display = 'inline-block', 300); 
});

window.addEventListener('click', (e) => {
    if (!menuBtn.contains(e.target) && !sideMenu.contains(e.target)) {
        sideMenu.classList.remove('show');
        setTimeout(() => menuBtn.style.display = 'inline-block', 300);
    }
});

// === Ø²Ø± Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ Ø£Ø³ÙÙ„ Ø§Ù„ÙÙˆØªØ± ===
//Ù‡Ù†Ø§Ùƒ Ø¹Ù†ØµØ± Ù…Ø¹ id="helpBtn" Ù„Ø°Ø§ Ù†ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯Ù‡ Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø­ØªÙ‰ Ù„Ø§ ÙŠØ³Ø¨Ø¨ Ø®Ø·Ø£.
const helpBtn = document.getElementById('helpBtn');
const helpModal = document.getElementById('helpModal');
if(helpBtn){
  helpBtn.addEventListener('mouseenter', ()=>{
      helpBtn.style.backgroundColor = 'rgba(255, 204, 0, 1)';
      helpBtn.style.boxShadow = '0 0 20px rgba(255,255,0,0.8)';
  });

  helpBtn.addEventListener('mouseleave', ()=>{
      helpBtn.style.backgroundColor = 'rgba(255, 204, 0, 0.4)';
      helpBtn.style.boxShadow = '0 0 10px rgba(255,255,0,0.3)';
  });

  helpBtn.addEventListener('click', ()=>{
      helpModal.style.display = 'block';
  });
}

window.addEventListener('click', (e)=>{
    if(e.target === helpModal){
        helpModal.style.display = 'none';
    }
});

// === ØªØµØ¯ÙŠØ± Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© ÙƒÙ…Ù„Ù JSON ===
function exportSmartWords() {
  try {
    const dataStr = JSON.stringify(smartWords, null, 2);
    const blob = new Blob([dataStr], { type: "application/json" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    // Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØºÙŠÙŠØ± Ù„Ùˆ Ø£Ø±Ø¯Øª
    a.download = "recovery_txt.json";
    a.click();

    URL.revokeObjectURL(url);
  } catch (err) {
    alert("ÙØ´Ù„ Ø§Ù„ØªØµØ¯ÙŠØ±");
  }
}

// === Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© Ù…Ù† Ù…Ù„Ù JSON ===
function importSmartWords(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const imported = JSON.parse(e.target.result);
      if (typeof imported === "object" && imported !== null) {
        // Ø¯Ù…Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯ Ù…Ø¹ smartWords Ø§Ù„Ø­Ø§Ù„ÙŠ
        smartWords = { ...smartWords, ...imported };
        renderSmartWords();
        alert("âˆš ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
      } else {
        alert("X ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­");
      }
    } catch (err) {
      alert("X Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­");
    }
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù‚ÙŠÙ…Ø© input Ø­ØªÙ‰ ØªØ³Ù…Ø­ Ø¨ØªØ­Ù…ÙŠÙ„ Ù†ÙØ³ Ø§Ù„Ù…Ù„Ù Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© Ø¥Ø°Ø§ Ø±ØºØ¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    event.target.value = "";
  };
  reader.readAsText(file);
}

// === Ø²Ø± "Ø¥Ø¯Ø±Ø§Ø¬ ØªØµØ­ÙŠØ­" ===
// === Ø²Ø± "Ø¥Ø¯Ø±Ø§Ø¬ ØªØµØ­ÙŠØ­" Ù…Ø¹ ØªØºÙŠÙŠØ± Ø§Ù„Ù†Øµ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ ===
const smartBtn = document.getElementById("smartWordsBtn");
const smartMenu = document.getElementById("smartWordsMenu");
let menuOpen = false;

smartBtn.addEventListener("click", (e) => {
  e.stopPropagation(); // Ù…Ù†Ø¹ Ø­Ø¯Ø« Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù†ÙØ³Ù‡
  menuOpen = !menuOpen;
  smartMenu.style.display = menuOpen ? "flex" : "none";
  smartBtn.innerText = menuOpen ? "Ø¥ØºÙ„Ø§Ù‚" : "Ø§Ø¯Ø±Ø§Ø¬ ØªØµØ­ÙŠØ­";
  smartMenu.style.flexDirection = "column";
});

// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø±
window.addEventListener("click", (e) => {
  if(menuOpen && !smartMenu.contains(e.target) && e.target !== smartBtn) {
    smartMenu.style.display = "none";
    smartBtn.innerText = "Ø§Ø¯Ø±Ø§Ø¬ ØªØµØ­ÙŠØ­";
    menuOpen = false;
  }
});

// Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø© + Ø§Ù„ØªØµØ­ÙŠØ­
function addSmartWord() {
  const wrong = document.getElementById("wrongWord").value.trim();
  const correct = document.getElementById("correctWord").value.trim();

  if (wrong && correct) {
    smartWords[wrong] = correct;
    renderSmartWords();
    document.getElementById("wrongWord").value = "";
    document.getElementById("correctWord").value = "";
  }
}

// Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©
function renderSmartWords() {
  const list = document.getElementById("smartWordsList");
  list.innerHTML = "";
  for (const wrong in smartWords) {
    const div = document.createElement("div");
    div.className = "smartWordItem";
    div.innerHTML = `<span>${wrong} â†’ ${smartWords[wrong]}</span>`;
    const delBtn = document.createElement("button");
    delBtn.innerText = "X";
    delBtn.onclick = () => {
      delete smartWords[wrong];
      renderSmartWords();
    };
    div.appendChild(delBtn);
    list.appendChild(div);
  }
}
</script>
</body>
</html>
