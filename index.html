<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¥Ù„Ù‰ Ù†Øµ</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f7f7f7;
      padding: 30px;
      direction: rtl;
      text-align: right;
      color: #333;
    }

    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 10px;
    }

    button:hover {
      background-color: #45a049;
    }

    #output {
      margin-top: 20px;
      background-color: #ffffff;
      border: 1px solid #ddd;
      padding: 20px;
      border-radius: 8px;
      font-size: 18px;
      min-height: 80px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      white-space: pre-wrap;
      line-height: 1.6;
    }

    #pasteBtn {
      display: none; /* Ù…Ø®ÙÙŠ Ø­ØªÙ‰ ÙŠÙƒØªÙ…Ù„ Ø§Ù„Ù†Ø³Ø® */
    }

    textarea {
      width: 100%;
      margin-top: 20px;
      padding: 12px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
      resize: vertical;
    }

    .container {
      max-width: 600px;
      margin: auto;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 20px;
      color: #222;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ™ï¸DRAGON:ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¥Ù„Ù‰ Ù†Øµ (Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù…)</h1>

    <button onclick="startVoiceAndCopy()"> âˆšØªØ­Ø¯Ø«ğŸ¤ Ù†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>

    <div id="output"></div>

    <button id="pasteBtn" onclick="pasteText()">ğŸ“‹ Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ù†Ø³ÙˆØ® ÙÙŠ Ø§Ù„Ø­Ù‚Ù„</button>

    <textarea id="textField" rows="4" placeholder="Ù‡Ù†Ø§ Ø³ÙŠØªÙ… Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±"></textarea>
  </div>

  <script>
    let latestCopiedText = "";

    function wordsToNumbersInText(text) {
      const numberWords = {
        "ØµÙØ±": 0, "ÙˆØ§Ø­Ø¯": 1, "ÙˆØ§Ø­Ø¯Ø©": 1, "Ø§Ø«Ù†Ø§Ù†": 2, "Ø§Ø«Ù†ÙŠÙ†": 2, "Ø§Ø«Ù†ØªØ§Ù†": 2, "Ø§Ø«Ù†ØªÙŠÙ†": 2,
        "Ø«Ù„Ø§Ø«Ø©": 3, "Ø£Ø±Ø¨Ø¹Ø©": 4, "Ø§Ø±Ø¨Ø¹Ø©": 4, "Ø®Ù…Ø³Ø©": 5, "Ø³ØªØ©": 6, "Ø³Ø¨Ø¹Ø©": 7, "Ø«Ù…Ø§Ù†ÙŠØ©": 8, "ØªØ³Ø¹Ø©": 9,
        "Ø¹Ø´Ø±Ø©": 10, "Ø£Ø­Ø¯ Ø¹Ø´Ø±": 11, "Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±": 12, "Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±": 13, "Ø£Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±": 14, "Ø®Ù…Ø³Ø© Ø¹Ø´Ø±": 15,
        "Ø³ØªØ© Ø¹Ø´Ø±": 16, "Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±": 17, "Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±": 18, "ØªØ³Ø¹Ø© Ø¹Ø´Ø±": 19,
        "Ø¹Ø´Ø±ÙˆÙ†": 20, "Ø«Ù„Ø§Ø«ÙˆÙ†": 30, "Ø£Ø±Ø¨Ø¹ÙˆÙ†": 40, "Ø®Ù…Ø³ÙˆÙ†": 50, "Ø³ØªÙˆÙ†": 60,
        "Ø³Ø¨Ø¹ÙˆÙ†": 70, "Ø«Ù…Ø§Ù†ÙˆÙ†": 80, "ØªØ³Ø¹ÙˆÙ†": 90,
        "Ù…Ø§Ø¦Ø©": 100, "Ù…Ø¦Ø©": 100, "Ù…Ø¦ØªØ§Ù†": 200, "Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©": 300, "Ø£Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©": 400,
        "Ø®Ù…Ø³Ù…Ø§Ø¦Ø©": 500, "Ø³ØªÙ…Ø§Ø¦Ø©": 600, "Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©": 700, "Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©": 800, "ØªØ³Ø¹Ù…Ø§Ø¦Ø©": 900,
        "Ø£Ù„Ù": 1000, "Ø§Ù„Ù": 1000, "Ø£Ù„ÙØ§Ù†": 2000, "Ø¢Ù„Ø§Ù": 3000
      };

      const multipliers = {
        "Ù…Ø§Ø¦Ø©": 100,
        "Ù…Ø¦Ø©": 100,
        "Ø£Ù„Ù": 1000,
        "Ø§Ù„Ù": 1000
      };

      text = text.replace(/ØŒ/g, " ");
      text = text.replace(/ Ùˆ /g, " ");
      const words = text.trim().split(/\s+/);

      let resultWords = [];
      let numberBuffer = [];

      function processNumberBuffer(buffer) {
        let total = 0;
        let current = 0;

        buffer.forEach(word => {
          word = word.toLowerCase();
          if (numberWords[word] !== undefined) {
            current += numberWords[word];
          } else if (multipliers[word] !== undefined) {
            if (current === 0) current = 1;
            current *= multipliers[word];
            total += current;
            current = 0;
          }
        });
        total += current;
        return total;
      }

      for (let i = 0; i < words.length; i++) {
        const word = words[i].toLowerCase();

        if (numberWords[word] !== undefined || multipliers[word] !== undefined) {
          numberBuffer.push(word);
        } else {
          if (numberBuffer.length > 0) {
            const num = processNumberBuffer(numberBuffer);
            resultWords.push(num.toString());
            numberBuffer = [];
          }
          resultWords.push(words[i]);
        }
      }

      if (numberBuffer.length > 0) {
        const num = processNumberBuffer(numberBuffer);
        resultWords.push(num.toString());
      }

      return resultWords.join(" ");
    }

    function startVoiceAndCopy() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SpeechRecognition) {
        alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¥Ù„Ù‰ Ù†Øµ");
        return;
      }

      const recognition = new SpeechRecognition();
      recognition.lang = 'ar-SA';
      recognition.interimResults = true;
      recognition.maxAlternatives = 1;

      let finalTranscript = "";

      recognition.onresult = function (event) {
        let interimTranscript = "";
        for (let i = event.resultIndex; i < event.results.length; i++) {
          if (event.results[i].isFinal) {
            finalTranscript += event.results[i][0].transcript + " ";
          } else {
            interimTranscript += event.results[i][0].transcript;
          }
        }
        document.getElementById("output").innerText = finalTranscript + interimTranscript;
      };

      recognition.onerror = function (event) {
        alert("âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ¹Ø±Ù: " + event.error);
      };

      recognition.onend = function () {
        if (finalTranscript.trim().length === 0) {
          alert("â— Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚Ø§Ø· Ø£ÙŠ ÙƒÙ„Ø§Ù….");
          return;
        }
        const processedText = wordsToNumbersInText(finalTranscript.trim());
        navigator.clipboard.writeText(processedText).then(() => {
          document.getElementById("output").innerText = processedText;
          latestCopiedText = processedText;
          document.getElementById("pasteBtn").style.display = "inline-block";
          alert("âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§. ÙŠÙ…ÙƒÙ†Ùƒ Ù„ØµÙ‚Ù‡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø²Ø± 'ğŸ“‹ Ù„ØµÙ‚'.");
        });
      };

      recognition.start();
    }

    function pasteText() {
      document.getElementById("textField").value = latestCopiedText || "";
    }
  </script>
</body>
</html>
