<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <title>ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒÙ„Ø§Ù… Ù„Ø£Ø±Ù‚Ø§Ù… (Ù…Ø¯Ø¹Ù‘Ù… Ù„Ù‡Ø¬Ø§Øª)</title>
  <style>
    body{font-family:Tahoma, Arial;direction:rtl;padding:20px;background:#111;color:#eee}
    button{padding:10px 16px;border-radius:8px;border:none;cursor:pointer;margin:6px}
    #startBtn{background:#4CAF50;color:#fff}
    #stopBtn{background:#f44336;color:#fff}
    #outputBox{margin-top:12px;background:#222;padding:12px;border-radius:8px;border:1px solid #333;min-height:60px}
  </style>
</head>
<body>
  <h2>Ø§Ø®ØªØ¨Ø§Ø± ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø©</h2>
  <button id="startBtn">â–¶ï¸ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„</button>
  <button id="stopBtn">âœ– Ø¥ÙŠÙ‚Ø§Ù</button>
  <div id="outputBox">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§</div>

<script>
/* ===== Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¥Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… (Ù…Ø¹ ØªØ·Ø¨ÙŠØ¹ Ù„Ù‡Ø¬Ø§Øª) ===== */
function wordsToNumbersInText(text){
  if(!text || !text.trim()) return text;

  // 1) ØªØ·Ø¨ÙŠØ¹ Ø£Ø­Ø±Ù Ø´Ø§Ø¦Ø¹Ø©
  text = text.toLowerCase();
  text = text.replace(/[Ø¥Ø£Ø¢]/g,"Ø§");
  text = text.replace(/Ù‰/g,"ÙŠ");
  text = text.replace(/Ø¤/g,"Ùˆ");
  text = text.replace(/Ø¦/g,"ÙŠ");
  text = text.replace(/Ø©/g,"Ø©"); // Ù†ØªØ±Ùƒ Ø§Ù„ØªØ§Ø¡ Ø§Ù„Ù…Ø±Ø¨ÙˆØ·Ø©
  text = text.replace(/[.,Ø›ØŒ!ØŸ]/g," ");
  text = text.replace(/\s+/g," ").trim();

  // 2) Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¹Ø¨Ø§Ø±Ø§Øª Ù…ÙƒÙˆÙ‘Ù†Ø© Ù…Ù† ÙƒÙ„Ù…ØªÙŠÙ† Ø¥Ù„Ù‰ ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø© (Ø­ØªÙ‰ Ù†Ø³Ø§ÙˆÙŠÙ‡Ø§ ÙÙŠ Ø§Ù„Ø®Ø±ÙŠØ·Ø©)
  const multiMap = {
    "Ø§Ø­Ø¯ Ø¹Ø´Ø±":"Ø§Ø­Ø¯_Ø¹Ø´Ø±","Ø§Ø­Ø¯Ù‰ Ø¹Ø´Ø±":"Ø§Ø­Ø¯Ù‰_Ø¹Ø´Ø±",
    "Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±":"Ø§Ø«Ù†Ø§_Ø¹Ø´Ø±","Ø§Ø«Ù†ÙŠ Ø¹Ø´Ø±":"Ø§Ø«Ù†Ø§_Ø¹Ø´Ø±","Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±":"Ø§Ø«Ù†Ø§_Ø¹Ø´Ø±",
    "Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±":"Ø«Ù„Ø§Ø«Ø©_Ø¹Ø´Ø±","Ø«Ù„Ø§Ø« Ø¹Ø´Ø±":"Ø«Ù„Ø§Ø«Ø©_Ø¹Ø´Ø±",
    "Ø§Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±":"Ø§Ø±Ø¨Ø¹Ø©_Ø¹Ø´Ø±","Ø§Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±":"Ø§Ø±Ø¨Ø¹Ø©_Ø¹Ø´Ø±",
    "Ø®Ù…Ø³Ø© Ø¹Ø´Ø±":"Ø®Ù…Ø³Ø©_Ø¹Ø´Ø±","Ø³ØªØ© Ø¹Ø´Ø±":"Ø³ØªØ©_Ø¹Ø´Ø±",
    "Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±":"Ø³Ø¨Ø¹Ø©_Ø¹Ø´Ø±","Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±":"Ø«Ù…Ø§Ù†ÙŠØ©_Ø¹Ø´Ø±","ØªØ³Ø¹Ø© Ø¹Ø´Ø±":"ØªØ³Ø¹Ø©_Ø¹Ø´Ø±"
  };
  Object.keys(multiMap).forEach(k=>{
    const re = new RegExp("\\b"+k+"\\b","g");
    text = text.replace(re, multiMap[k]);
  });

  // 3) Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ø§Øª Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„Ù„Ù‡Ø¬ÙŠ (Ù†ÙˆØ¹Ø§Ù‹ Ù…Ø§ Ø´Ø§Ù…Ù„Ø©)
  const variantMap = {
    // Ù…Ø¦Ø§Øª Ù„Ù‡Ø¬Ø§Øª/Ø£Ø®Ø·Ø§Ø¡ Ø´Ø§Ø¦Ø¹Ø© => Ù†Ø·Ø§Ø¨Ù‚ Ù…ÙØ±Ø¯Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ hundreds map
    "Ù…ÙŠÙ‡":"Ù…ÙŠØ©","Ù…ÙŠÙ‘Ø©":"Ù…ÙŠØ©","Ù…ÙŠÙ‡":"Ù…ÙŠØ©","Ù…ÙŠÙ‡":"Ù…ÙŠØ©",
    "ØªØ³Ø¹Ù…ÙŠÙ‡":"ØªØ³Ø¹Ù…ÙŠØ©","ØªØ³Ø¹Ù…Ø§ÙŠØ©":"ØªØ³Ø¹Ù…ÙŠØ©","ØªØ³Ø¹Ù…ÙŠØ©":"ØªØ³Ø¹Ù…ÙŠØ©",
    "ØªØ³Ø¹Ù…":"ØªØ³Ø¹Ù…ÙŠØ©",
    "Ø³Ø¨Ø¹Ù…ÙŠÙ‡":"Ø³Ø¨Ø¹Ù…ÙŠØ©","Ø³Ø¨Ø¹Ù…Ø§ÙŠØ©":"Ø³Ø¨Ø¹Ù…ÙŠØ©",
    "Ø³ØªÙ…ÙŠÙ‡":"Ø³ØªÙ…ÙŠØ©","Ø³ØªÙ…":"Ø³ØªÙ…ÙŠØ©",
    "Ø«Ù…Ù†Ù…ÙŠÙ‡":"Ø«Ù…Ø§Ù†Ù…ÙŠØ©","ØªÙ…Ù†Ù…ÙŠØ©":"Ø«Ù…Ø§Ù†Ù…ÙŠØ©","Ø§Ø«Ù…Ù†Ù…ÙŠÙ‡":"Ø«Ù…Ø§Ù†Ù…ÙŠØ©","Ø§Ø«Ù…Ù†Ù…ÙŠØ©":"Ø«Ù…Ø§Ù†Ù…ÙŠØ©",
    "Ø«Ù…Ø§Ù†Ù…ÙŠÙ‡":"Ø«Ù…Ø§Ù†Ù…ÙŠØ©","Ø«Ù…Ø§Ù†Ù…ÙŠØ©":"Ø«Ù…Ø§Ù†Ù…ÙŠØ©",
    "ØªÙ„Ø§ØªÙ‡":"Ø«Ù„Ø§Ø«Ø©","ØªÙ„Ø§Øª":"Ø«Ù„Ø§Ø«Ø©","ØªÙ„Øª":"Ø«Ù„Ø§Ø«Ø©",
    "ØªÙ…Ù†ÙŠÙ‡":"Ø«Ù…Ø§Ù†ÙŠØ©","ØªÙ…Ø§Ù†ÙŠØ©":"Ø«Ù…Ø§Ù†ÙŠØ©",
    // ÙƒÙ„Ù…Ø§Øª Ø§Ø®Ø±Ù‰ Ù…Ù…ÙƒÙ† ÙŠÙ‚Ø±Ø£Ù‡Ø§ ASR
    "Ø§Ù„ÙÙŠÙ†":"Ø§Ù„ÙÙŠÙ†","Ø§Ù„ÙÙŠÙ†":"Ø§Ù„ÙÙŠÙ†"
  };
  Object.keys(variantMap).forEach(k=>{
    const re = new RegExp("\\b"+k+"\\b","g");
    text = text.replace(re, variantMap[k]);
  });

  // 4) Ù…Ø§Ø¨ Ø§Ù„Ù‚ÙŠÙ… (Ø´Ø§Ù…Ù„ Ù„Ù‡Ø¬Ø§Øª/ØµÙŠØ§ØºØ§Øª)
  const units = {
    "ØµÙØ±":0,"ÙˆØ§Ø­Ø¯":1,"ÙˆØ§Ø­Ø¯Ø©":1,"Ø§Ø­Ø¯":1,"Ø§Ø­Ø¯Ù‰":1,
    "Ø§Ø«Ù†Ø§Ù†":2,"Ø§Ø«Ù†ÙŠÙ†":2,"Ø§ØªÙ†ÙŠÙ†":2,"Ø§Ø«Ù†ØªØ§Ù†":2,"Ø§Ø«Ù†ØªÙŠÙ†":2,"Ø«Ù†ÙŠÙ†":2,
    "Ø«Ù„Ø§Ø«Ø©":3,"Ø«Ù„Ø§Ø«":3,"ØªÙ„Ø§ØªØ©":3,"ØªÙ„Ø§ØªÙ‡":3,
    "Ø§Ø±Ø¨Ø¹Ø©":4,"Ø§Ø±Ø¨Ø¹":4,
    "Ø®Ù…Ø³Ø©":5,"Ø®Ù…Ø³":5,
    "Ø³ØªØ©":6,"Ø³Øª":6,
    "Ø³Ø¨Ø¹Ø©":7,"Ø³Ø¨Ø¹":7,
    "Ø«Ù…Ø§Ù†ÙŠØ©":8,"Ø«Ù…Ø§Ù†":8,"ØªÙ…Ø§Ù†ÙŠØ©":8,"ØªÙ…Ù†ÙŠÙ‡":8,"Ø«Ù…Ù†ÙŠÙ‡":8,
    "ØªØ³Ø¹Ø©":9,"ØªØ³Ø¹":9
  };

  const teens = {
    "Ø§Ø­Ø¯_Ø¹Ø´Ø±":11,"Ø§Ø­Ø¯Ù‰_Ø¹Ø´Ø±":11,"Ø§Ø«Ù†Ø§_Ø¹Ø´Ø±":12,"Ø«Ù„Ø§Ø«Ø©_Ø¹Ø´Ø±":13,"Ø§Ø±Ø¨Ø¹Ø©_Ø¹Ø´Ø±":14,
    "Ø®Ù…Ø³Ø©_Ø¹Ø´Ø±":15,"Ø³ØªØ©_Ø¹Ø´Ø±":16,"Ø³Ø¨Ø¹Ø©_Ø¹Ø´Ø±":17,"Ø«Ù…Ø§Ù†ÙŠØ©_Ø¹Ø´Ø±":18,"ØªØ³Ø¹Ø©_Ø¹Ø´Ø±":19,
    "Ø¹Ø´Ø±Ø©":10,"Ø¹Ø´Ø±":10
  };

  const tens = {
    "Ø¹Ø´Ø±ÙˆÙ†":20,"Ø¹Ø´Ø±ÙŠÙ†":20,"Ø«Ù„Ø§Ø«ÙˆÙ†":30,"Ø«Ù„Ø§Ø«ÙŠÙ†":30,"ØªÙ„Ø§ØªÙŠÙ†":30,
    "Ø§Ø±Ø¨Ø¹ÙˆÙ†":40,"Ø§Ø±Ø¨Ø¹ÙŠÙ†":40,"Ø®Ù…Ø³ÙˆÙ†":50,"Ø®Ù…Ø³ÙŠÙ†":50,
    "Ø³ØªÙˆÙ†":60,"Ø³ØªÙŠÙ†":60,"Ø³Ø¨Ø¹ÙˆÙ†":70,"Ø³Ø¨Ø¹ÙŠÙ†":70,
    "Ø«Ù…Ø§Ù†ÙˆÙ†":80,"Ø«Ù…Ø§Ù†ÙŠÙ†":80,"ØªØ³Ø¹ÙˆÙ†":90,"ØªØ³Ø¹ÙŠÙ†":90
  };

  const hundreds = {
    "Ù…Ø§Ø¦Ø©":100,"Ù…Ø¦Ø©":100,"Ù…ÙŠØ©":100,"Ù…ÙŠÙ‡":100,
    "Ù…Ø¦ØªÙŠÙ†":200,"Ù…ÙŠØªÙŠÙ†":200,
    "Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©":300,"Ø«Ù„Ø§Ø«Ù…ÙŠØ©":300,"Ø«Ù„Ø§Ø«Ù…ÙŠØ©":300,
    "Ø§Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©":400,"Ø§Ø±Ø¨Ø¹Ù…ÙŠØ©":400,"Ø§Ø±Ø¨Ø¹Ù…Ø§ÙŠØ©":400,
    "Ø®Ù…Ø³Ù…Ø§Ø¦Ø©":500,"Ø®Ù…Ø³Ù…ÙŠØ©":500,"Ø®Ù…Ø³Ù…Ø§ÙŠØ©":500,
    "Ø³ØªÙ…Ø§Ø¦Ø©":600,"Ø³ØªÙ…ÙŠØ©":600,"Ø³ØªÙ…ÙŠØ©":600,
    "Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©":700,"Ø³Ø¨Ø¹Ù…ÙŠØ©":700,"Ø³Ø¨Ø¹Ù…ÙŠØ©":700,
    "Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©":800,"Ø«Ù…Ø§Ù†Ù…ÙŠØ©":800,"ØªÙ…Ù†Ù…ÙŠØ©":800,"Ø«Ù…Ù†Ù…ÙŠØ©":800,"ØªÙ…Ù†Ù…ÙŠØ©":800,
    "ØªØ³Ø¹Ù…Ø§Ø¦Ø©":900,"ØªØ³Ø¹Ù…ÙŠØ©":900
  };

  const multipliers = {
    "Ø£Ù„Ù":1000,"Ø§Ù„Ù":1000,"Ø§Ù„ÙÙŠÙ†":2000,"Ø£Ù„ÙÙŠÙ†":2000,"Ø¢Ù„Ø§Ù":1000,
    "Ù…Ù„ÙŠÙˆÙ†":1000000,"Ù…Ù„Ø§ÙŠÙŠÙ†":1000000,
    "Ù…Ù„ÙŠØ§Ø±":1000000000,"Ù…Ù„ÙŠØ§Ø±Ø§Øª":1000000000
  };

  const allWords = Object.assign({}, units, teens, tens, hundreds, multipliers);

  // 5) ØªÙÙƒÙŠÙƒ Ø¥Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª Ù…Ø¹ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙˆØ§Ùˆ Ø§Ù„Ù…Ù„ØªØµÙ‚Ø© Ù…Ø«Ù„ "ÙˆØ«Ù…Ø§Ù†ÙŠÙ†" -> "Ø«Ù…Ø§Ù†ÙŠÙ†"
  let rawTokens = text.split(/\s+/).map(t=>{
    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙƒÙ„Ù…Ø© Ù„Ù‡Ø§ ÙˆÙ…Ù„ØªØµÙ‚Ø© ÙÙŠ Ø¨Ø¯Ø§ÙŠØªÙ‡Ø§ØŒ Ù†Ø²ÙŠÙ„ Ø§Ù„ÙˆØ§Ùˆ Ø§Ù„Ø§Ù„ØªØµØ§Ù‚ÙŠØ©
    return t.replace(/^Ùˆ(?=[\u0621-\u064A])/,'');
  });

  // 6) Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ù†Ø­ØªÙØ¸ Ø¨Ù…Ø§ Ù‡Ùˆ Ù†Øµ ÙˆÙ†Ø­ÙˆÙ‘Ù„ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¥Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø±Ù‚Ù…ÙŠØ©
  let resultParts = [];
  let buffer = [];

  function flushBuffer(){
    if(buffer.length===0) return null;
    let total = 0, current = 0;
    buffer.forEach(w=>{
      if(teens[w]!==undefined){
        current += teens[w];
      } else if(units[w]!==undefined){
        current += units[w];
      } else if(tens[w]!==undefined){
        current += tens[w];
      } else if(hundreds[w]!==undefined){
        current += hundreds[w];
      } else if(multipliers[w]!==undefined){
        let m = multipliers[w];
        if(current === 0) current = 1;
        current = current * m;
        total += current;
        current = 0;
      } else {
        // ÙƒÙ„Ù…Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨Ø§ÙØ± -> Ù†ØªØ¬Ø§Ù‡Ù„Ù‡Ø§ ÙƒØ±Ù‚Ù…
      }
    });
    total += current;
    buffer = [];
    return total;
  }

  for(let i=0;i<rawTokens.length;i++){
    const w = rawTokens[i];
    if(allWords[w]!==undefined){
      buffer.push(w);
    } else {
      const n = flushBuffer();
      if(n!==null){
        resultParts.push(String(n));
      }
      resultParts.push(w);
    }
  }
  const lastNum = flushBuffer();
  if(lastNum!==null) resultParts.push(String(lastNum));

  // Ø¥Ø¹Ø§Ø¯Ø© Ø¯Ù…Ø¬ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙƒØ³Ù„Ø³Ù„Ø© (Ù†ØªØ±Ùƒ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø¨ÙŠÙ† Ø§Ù„ÙƒÙ„Ù…Ø§Øª)
  return resultParts.join(" ");
}



/* ===== Ù…Ø­Ø±Ùƒ Ø§Ù„ØµÙˆØª (webkitSpeechRecognition) ===== */
let recognition;
if(!("webkitSpeechRecognition" in window)){
  document.getElementById('outputBox').innerText = "Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… webkitSpeechRecognition. Ø§Ø³ØªØ®Ø¯Ù… Chrome.";
} else {
  recognition = new webkitSpeechRecognition();
  recognition.lang = "ar-IQ"; // Ù„Ù‡Ø¬Ø© Ø¹Ø±Ø§Ù‚ÙŠØ©
  recognition.interimResults = false;
  recognition.continuous = false;

  recognition.onstart = function(){
    document.getElementById('outputBox').innerText = "ğŸ™ï¸ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹... Ù‚Ù„ Ø¬Ù…Ù„Ø© ØªØ­ØªÙˆÙŠ Ø£Ø±Ù‚Ø§Ù…Ø§Ù‹ Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø©";
  };

  recognition.onresult = function(ev){
    const transcript = ev.results[0][0].transcript.trim();
    const converted = wordsToNumbersInText(transcript);
    document.getElementById('outputBox').innerHTML = "<b>Ø§Ù„Ù†Øµ:</b> "+transcript+"<br><b>Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„:</b> "+converted;
    console.log("transcript:",transcript,"converted:",converted);
  };

  recognition.onerror = function(e){
    console.error(e);
    document.getElementById('outputBox').innerText = "Ø­Ø¯Ø« Ø®Ø·Ø£: "+ (e.error || "unknown");
  };

  recognition.onend = function(){
    // Ù„Ø§ Ù†ÙØ¹Ù„ Ø´ÙŠØ¡ Ø®Ø§Øµ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ (ÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ø§Ù„Ø¶ØºØ·)
  };
}

/* ===== Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± ===== */
document.getElementById('startBtn').addEventListener('click', ()=>{
  if(recognition) recognition.start();
});
document.getElementById('stopBtn').addEventListener('click', ()=>{
  if(recognition) recognition.stop();
});
</script>
</body>
</html>
